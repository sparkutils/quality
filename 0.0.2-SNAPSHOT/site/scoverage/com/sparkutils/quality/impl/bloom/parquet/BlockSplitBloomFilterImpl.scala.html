<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title id="title">
          com/sparkutils/quality/impl/bloom/parquet/BlockSplitBloomFilterImpl.scala.html
        </title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/css/theme.default.min.css" type="text/css"/><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.20.1/js/jquery.tablesorter.min.js"></script><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" type="text/css"/><script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script><script type="text/javascript">
        $(document).ready(function() {$(".tablesorter").tablesorter();});
      </script>
        <style>
          table.codegrid { font-family: monospace; font-size: 12px; width: auto!important; }table.statementlist { width: auto!important; font-size: 13px; } table.codegrid td { padding: 0!important; border: 0!important } table td.linenumber { width: 40px!important; } 
        </style>
      </head>
      <body style="font-family: monospace;">
        <ul class="nav nav-tabs">
          <li>
            <a href="#codegrid" data-toggle="tab">Codegrid</a>
          </li>
          <li>
            <a href="#statementlist" data-toggle="tab">Statement List</a>
          </li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="codegrid">
            <pre style='font-size: 12pt; font-family: courier, monospace;'>1 <span style=''>package com.sparkutils.quality.impl.bloom.parquet
</span>2 <span style=''>
</span>3 <span style=''>import java.io.IOException
</span>4 <span style=''>import java.io.OutputStream
</span>5 <span style=''>import java.nio.ByteBuffer
</span>6 <span style=''>import java.nio.ByteOrder
</span>7 <span style=''>import java.nio.IntBuffer
</span>8 <span style=''>import java.util
</span>9 <span style=''>
</span>10 <span style=''>import com.sparkutils.quality.utils.TransientHolder
</span>11 <span style=''>
</span>12 <span style=''>/*
</span>13 <span style=''> * Licensed to the Apache Software Foundation (ASF) under one
</span>14 <span style=''> * or more contributor license agreements.  See the NOTICE file
</span>15 <span style=''> * distributed with this work for additional information
</span>16 <span style=''> * regarding copyright ownership.  The ASF licenses this file
</span>17 <span style=''> * to you under the Apache License, Version 2.0 (the
</span>18 <span style=''> * &quot;License&quot;); you may not use this file except in compliance
</span>19 <span style=''> * with the License.  You may obtain a copy of the License at
</span>20 <span style=''> *
</span>21 <span style=''> *   http://www.apache.org/licenses/LICENSE-2.0
</span>22 <span style=''> *
</span>23 <span style=''> * Unless required by applicable law or agreed to in writing,
</span>24 <span style=''> * software distributed under the License is distributed on an
</span>25 <span style=''> * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
</span>26 <span style=''> * KIND, either express or implied.  See the License for the
</span>27 <span style=''> * specific language governing permissions and limitations
</span>28 <span style=''> * under the License.
</span>29 <span style=''> */
</span>30 <span style=''>
</span>31 <span style=''>
</span>32 <span style=''>trait BlockSplitBloomFilterImports {
</span>33 <span style=''>  import com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.{BITS_PER_BLOCK, LOWER_BOUND_BYTES, UPPER_BOUND_BYTES}
</span>34 <span style=''>
</span>35 <span style=''>  /**
</span>36 <span style=''>   * Calculate optimal size according to the number of distinct values and false positive probability.
</span>37 <span style=''>   *
</span>38 <span style=''>   * @param n : The number of distinct values.
</span>39 <span style=''>   * @param p : The false positive probability.
</span>40 <span style=''>   * @return optimal number of bits of given n and p.
</span>41 <span style=''>   */
</span>42 <span style=''>  def optimalNumOfBits(n: Long, p: Double): Int = {
</span>43 <span style=''>    </span><span style='background: #AEF1AE'>require(p &gt; 0.0 &amp;&amp; p &lt; 1.0, </span><span style='background: #F0ADAD'>&quot;FPP should be less than 1.0 and great than 0.0&quot;</span><span style='background: #AEF1AE'>)</span><span style=''>
</span>44 <span style=''>    val m = </span><span style='background: #AEF1AE'>-8 * n / Math.log(1 - Math.pow(p, 1.0 / 8))</span><span style=''>
</span>45 <span style=''>    var numBits = </span><span style='background: #AEF1AE'>m.toInt</span><span style=''> // 2147483647
</span>46 <span style=''>    // Handle overflow.
</span>47 <span style=''>    if (</span><span style='background: #AEF1AE'>numBits &gt; (UPPER_BOUND_BYTES &lt;&lt; 3) || m &lt; 0</span><span style=''>) {
</span>48 <span style=''>      </span><span style='background: #AEF1AE'>numBits = UPPER_BOUND_BYTES &lt;&lt; 3</span><span style=''> // 1073741824
</span>49 <span style=''>    }
</span>50 <span style=''>
</span>51 <span style=''>    // Round numBits up to (k * BITS_PER_BLOCK)
</span>52 <span style=''>    numBits = </span><span style='background: #AEF1AE'>(numBits + BITS_PER_BLOCK - 1) &amp; ~BITS_PER_BLOCK</span><span style=''> // 1073742079
</span>53 <span style=''>
</span>54 <span style=''>    if (</span><span style='background: #AEF1AE'>numBits &lt; (LOWER_BOUND_BYTES &lt;&lt; 3)</span><span style=''>) {
</span>55 <span style=''>      </span><span style='background: #AEF1AE'>numBits = LOWER_BOUND_BYTES &lt;&lt; 3</span><span style=''>
</span>56 <span style=''>    }
</span>57 <span style=''>    numBits
</span>58 <span style=''>  }
</span>59 <span style=''>
</span>60 <span style=''>  def optimalNumberOfBuckets(n: Long, p: Double): Long = {
</span>61 <span style=''>
</span>62 <span style=''>    def directNumberOfBits(n: Long, p: Double): Long = {
</span>63 <span style=''>      </span><span style='background: #AEF1AE'>require(p &gt; 0.0 &amp;&amp; p &lt; 1.0, </span><span style='background: #F0ADAD'>&quot;FPP should be less than 1.0 and great than 0.0&quot;</span><span style='background: #AEF1AE'>)</span><span style=''>
</span>64 <span style=''>      val m = (</span><span style='background: #AEF1AE'>-8L * n).toDouble / Math.log(1L - Math.pow(p, 1.0 / 8d))</span><span style=''>
</span>65 <span style=''>      </span><span style='background: #AEF1AE'>m.toLong</span><span style=''>
</span>66 <span style=''>    }
</span>67 <span style=''>
</span>68 <span style=''>    val origBytes = </span><span style='background: #AEF1AE'>directNumberOfBits(n, p) / 8</span><span style=''> // bytes
</span>69 <span style=''>    var numBytes = </span><span style='background: #AEF1AE'>optimalNumOfBits(n, p) / 8</span><span style=''> // 134217759
</span>70 <span style=''>    if (</span><span style='background: #AEF1AE'>(numBytes &amp; (numBytes - 1)) != 0</span><span style=''>) </span><span style='background: #AEF1AE'>numBytes = Integer.highestOneBit(numBytes) &lt;&lt; 1</span><span style=''> // 268435456
</span>71 <span style=''>    if (</span><span style='background: #AEF1AE'>numBytes &gt; UPPER_BOUND_BYTES || numBytes &lt; 0</span><span style=''>) </span><span style='background: #AEF1AE'>numBytes = UPPER_BOUND_BYTES</span><span style=''>    // 134217728 -- is num bytes so we want prev?
</span>72 <span style=''>
</span>73 <span style=''>    // numBytes is now likely UPPER_BOUND_BYTES anyway to use buckets - but how may bytes off are we?
</span>74 <span style=''>    if (</span><span style='background: #AEF1AE'>numBytes &gt; origBytes</span><span style=''>)
</span>75 <span style=''>      (</span><span style='background: #AEF1AE'>numBytes.toDouble / origBytes.toDouble).ceil.toLong</span><span style=''>
</span>76 <span style=''>    else
</span>77 <span style=''>      (</span><span style='background: #AEF1AE'>origBytes.toDouble / numBytes.toDouble).ceil.toLong</span><span style=''>
</span>78 <span style=''>  }
</span>79 <span style=''>
</span>80 <span style=''>}
</span>81 <span style=''>
</span>82 <span style=''>/*
</span>83 <span style=''> * This Bloom filter is implemented using block-based Bloom filter algorithm from Putze et al.'s
</span>84 <span style=''> * &quot;Cache-, Hash- and Space-Efficient Bloom filters&quot;. The basic idea is to hash the item to a tiny
</span>85 <span style=''> * Bloom filter which size fit a single cache line or smaller. This implementation sets 8 bits in
</span>86 <span style=''> * each tiny Bloom filter. Each tiny Bloom filter is 32 bytes to take advantage of 32-byte SIMD
</span>87 <span style=''> * instruction.
</span>88 <span style=''> */
</span>89 <span style=''>object BlockSplitBloomFilterImpl { // Bytes in a tiny Bloom filter block.
</span>90 <span style=''>  private[parquet] val BYTES_PER_BLOCK = </span><span style='background: #AEF1AE'>32</span><span style=''>
</span>91 <span style=''>  // Bits in a tiny Bloom filter block.
</span>92 <span style=''>  private[parquet] val BITS_PER_BLOCK = </span><span style='background: #AEF1AE'>256</span><span style=''>
</span>93 <span style=''>  // The lower bound of bloom filter size, set to the size of a tiny Bloom filter block.
</span>94 <span style=''>  val LOWER_BOUND_BYTES = </span><span style='background: #AEF1AE'>32</span><span style=''>
</span>95 <span style=''>  // The upper bound of bloom filter size, set to default row group size.
</span>96 <span style=''>  val UPPER_BOUND_BYTES: Int = </span><span style='background: #AEF1AE'>128 * 1024 * 1024</span><span style=''>
</span>97 <span style=''>  // The number of bits to set in a tiny Bloom filter
</span>98 <span style=''>  private[parquet] val BITS_SET_PER_BLOCK = </span><span style='background: #AEF1AE'>8</span><span style=''>
</span>99 <span style=''>  // The metadata in the header of a serialized Bloom filter is four four-byte values: the number of bytes,
</span>100 <span style=''>  // the filter algorithm, the hash algorithm, and the compression.
</span>101 <span style=''>  val HEADER_SIZE = </span><span style='background: #AEF1AE'>16</span><span style=''>
</span>102 <span style=''>  // The default false positive probability value
</span>103 <span style=''>  val DEFAULT_FPP = </span><span style='background: #AEF1AE'>0.01</span><span style=''>
</span>104 <span style=''>  // The block-based algorithm needs 8 odd SALT values to calculate eight indexes
</span>105 <span style=''>  // of bits to set, one per 32-bit word.
</span>106 <span style=''>  private[parquet] val SALT = </span><span style='background: #AEF1AE'>Array(0x47b6137b, 0x44974d91, 0x8824ad5b, 0xa2b7289d, 0x705495c7, 0x2df1424b, 0x9efc4947, 0x5c6bfb31)</span><span style=''>
</span>107 <span style=''>
</span>108 <span style=''>  def fromBytes(bitset: Array[Byte]): BlockSplitBloomFilterImpl = {
</span>109 <span style=''>    </span><span style='background: #AEF1AE'>apply(bitset)</span><span style=''>
</span>110 <span style=''>  }
</span>111 <span style=''>
</span>112 <span style=''>  /**
</span>113 <span style=''>   * Construct the Bloom filter with given bitset, it is used when reconstructing
</span>114 <span style=''>   * Bloom filter from parquet file. It use XXH64 as its default hash
</span>115 <span style=''>   * function.
</span>116 <span style=''>   *
</span>117 <span style=''>   * @param bitset The given bitset to construct Bloom filter.
</span>118 <span style=''>   */
</span>119 <span style=''>  def apply(bitset: Array[Byte]): BlockSplitBloomFilterImpl = {
</span>120 <span style=''>    </span><span style='background: #AEF1AE'>apply(bitset, BloomFilter.XXH64)</span><span style=''>
</span>121 <span style=''>  }
</span>122 <span style=''>
</span>123 <span style=''>  def arrayBacked(bits: Array[Byte]): TransientHolder[BufferAndRaw] = {
</span>124 <span style=''>
</span>125 <span style=''>    val ibuffer = </span><span style='background: #AEF1AE'>TransientHolder{ () =&gt;
</span>126 <span style=''></span><span style='background: #AEF1AE'>      val buf = ByteBuffer.wrap(bits).order(ByteOrder.LITTLE_ENDIAN).asIntBuffer
</span>127 <span style=''></span><span style='background: #AEF1AE'>      BufferAndRaw(buf, Some(bits))
</span>128 <span style=''></span><span style='background: #AEF1AE'>    }</span><span style=''>
</span>129 <span style=''>    ibuffer
</span>130 <span style=''>  }
</span>131 <span style=''>
</span>132 <span style=''>
</span>133 <span style=''>  /**
</span>134 <span style=''>   * Construct the Bloom filter with given bitset, it is used when reconstructing
</span>135 <span style=''>   * Bloom filter from parquet file.
</span>136 <span style=''>   *
</span>137 <span style=''>   * @param bitset       The given bitset to construct Bloom filter.
</span>138 <span style=''>   * @param hashImpl A hashImpl, no attempt at thread safety is made here, the caller must ensure thread safety
</span>139 <span style=''>   */
</span>140 <span style=''>  def apply(bitset: Array[Byte], hashImpl: BloomHash): BlockSplitBloomFilterImpl = {
</span>141 <span style=''>
</span>142 <span style=''>    val bs = </span><span style='background: #AEF1AE'>BlockSplitBloomFilterImpl(arrayBacked(bitset), hashImpl)</span><span style=''>
</span>143 <span style=''>
</span>144 <span style=''>    bs
</span>145 <span style=''>  }
</span>146 <span style=''>
</span>147 <span style=''>  /**
</span>148 <span style=''>   * Construct the Bloom filter with given bitset, it is used when reconstructing
</span>149 <span style=''>   * Bloom filter from parquet file.
</span>150 <span style=''>   *
</span>151 <span style=''>   * @param bitset       The given bitset to construct Bloom filter.
</span>152 <span style=''>   * @param hashStrategy The hash strategy Bloom filter apply.
</span>153 <span style=''>   */
</span>154 <span style=''>  def apply(bitset: Array[Byte], hashStrategy: BloomFilter.HashStrategy): BlockSplitBloomFilterImpl =
</span>155 <span style=''>    </span><span style='background: #AEF1AE'>apply(bitset,  new BloomHashImpl(hashStrategy))</span><span style=''>
</span>156 <span style=''>
</span>157 <span style=''>
</span>158 <span style=''>  def bufferEquals(left: IntBuffer, right: IntBuffer) =
</span>159 <span style=''>    if (</span><span style='background: #F0ADAD'>left.limit() == right.limit()</span><span style=''>) </span><span style='background: #F0ADAD'>{
</span>160 <span style=''></span><span style='background: #F0ADAD'>      var i = -1
</span>161 <span style=''></span><span style='background: #F0ADAD'>      do {
</span>162 <span style=''></span><span style='background: #F0ADAD'>        i += 1
</span>163 <span style=''></span><span style='background: #F0ADAD'>      } while( i &lt; right.limit() &amp;&amp; left.get(i) == right.get(i) )
</span>164 <span style=''></span><span style='background: #F0ADAD'>      if ((i+1) == right.limit())
</span>165 <span style=''></span><span style='background: #F0ADAD'>        true // got to the end
</span>166 <span style=''></span><span style='background: #F0ADAD'>      else
</span>167 <span style=''></span><span style='background: #F0ADAD'>        false // did not there is a difference
</span>168 <span style=''></span><span style='background: #F0ADAD'>    }</span><span style=''> else
</span>169 <span style=''>      </span><span style='background: #F0ADAD'>false</span><span style=''>
</span>170 <span style=''>
</span>171 <span style=''>  /**
</span>172 <span style=''>   * Creates using an array
</span>173 <span style=''>   *
</span>174 <span style=''>   * @param numBytes
</span>175 <span style=''>   * @param iMinimumBytes
</span>176 <span style=''>   * @param iMaximumBytes
</span>177 <span style=''>   * @param hashImpl
</span>178 <span style=''>   * @return
</span>179 <span style=''>   */
</span>180 <span style=''>  def apply(numBytes: Int, iMinimumBytes: Int, iMaximumBytes: Int, hashImpl: BloomHash): BlockSplitBloomFilterImpl =
</span>181 <span style=''>    </span><span style='background: #AEF1AE'>apply(createArray(numBytes, iMinimumBytes, iMaximumBytes), hashImpl)</span><span style=''>
</span>182 <span style=''>
</span>183 <span style=''>  def createArray(numBytes: Int, iMinimumBytes: Int, iMaximumBytes: Int) = </span><span style='background: #AEF1AE'>new Array[Byte]({
</span>184 <span style=''></span><span style='background: #AEF1AE'>
</span>185 <span style=''></span><span style='background: #AEF1AE'>
</span>186 <span style=''></span><span style='background: #AEF1AE'>    val maximumBytes =
</span>187 <span style=''></span><span style='background: #AEF1AE'>      if (iMaximumBytes &gt; BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES &amp;&amp; iMaximumBytes &lt; BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)
</span>188 <span style=''></span><span style='background: #AEF1AE'>        </span><span style='background: #F0ADAD'>iMaximumBytes</span><span style='background: #AEF1AE'>
</span>189 <span style=''></span><span style='background: #AEF1AE'>      else
</span>190 <span style=''></span><span style='background: #AEF1AE'>        BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
</span>191 <span style=''></span><span style='background: #AEF1AE'>    val minimumBytes =
</span>192 <span style=''></span><span style='background: #AEF1AE'>      if (iMinimumBytes &gt; BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES &amp;&amp; </span><span style='background: #F0ADAD'>iMinimumBytes &lt; BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES</span><span style='background: #AEF1AE'>)
</span>193 <span style=''></span><span style='background: #AEF1AE'>        </span><span style='background: #F0ADAD'>iMaximumBytes</span><span style='background: #AEF1AE'>
</span>194 <span style=''></span><span style='background: #AEF1AE'>      else
</span>195 <span style=''></span><span style='background: #AEF1AE'>        BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
</span>196 <span style=''></span><span style='background: #AEF1AE'>
</span>197 <span style=''></span><span style='background: #AEF1AE'>    var inumBytes = numBytes
</span>198 <span style=''></span><span style='background: #AEF1AE'>    if (inumBytes &lt; minimumBytes) {
</span>199 <span style=''></span><span style='background: #AEF1AE'>      </span><span style='background: #F0ADAD'>inumBytes = minimumBytes</span><span style='background: #AEF1AE'>
</span>200 <span style=''></span><span style='background: #AEF1AE'>    }
</span>201 <span style=''></span><span style='background: #AEF1AE'>    // Get next power of 2 if it is not power of 2.
</span>202 <span style=''></span><span style='background: #AEF1AE'>    if ((inumBytes &amp; (inumBytes - 1)) != 0) inumBytes = Integer.highestOneBit(inumBytes) &lt;&lt; 1
</span>203 <span style=''></span><span style='background: #AEF1AE'>    if (inumBytes &gt; maximumBytes || inumBytes &lt; 0) </span><span style='background: #F0ADAD'>inumBytes = maximumBytes</span><span style='background: #AEF1AE'>
</span>204 <span style=''></span><span style='background: #AEF1AE'>
</span>205 <span style=''></span><span style='background: #AEF1AE'>    inumBytes
</span>206 <span style=''></span><span style='background: #AEF1AE'>  })</span><span style=''>
</span>207 <span style=''>
</span>208 <span style=''>}
</span>209 <span style=''>
</span>210 <span style=''>case class BufferAndRaw(buffer: IntBuffer, bytes: Option[Array[Byte]] = None)
</span>211 <span style=''>
</span>212 <span style=''>/**
</span>213 <span style=''> * Constructor of block-based Bloom filter.
</span>214 <span style=''> *
</span>215 <span style=''> * @param intBufferGen Creates the backing buffer
</span>216 <span style=''> * @param hashImpl Manages hashing for this bloomfilter
</span>217 <span style=''> */
</span>218 <span style=''>case class BlockSplitBloomFilterImpl(intBufferGen: TransientHolder[BufferAndRaw], hashImpl: BloomHash) extends
</span>219 <span style=''>  BloomFilter[Array[Byte]] with BloomLookupImpl with Bloom[Array[Byte]] with DelegatingBloomHash { // The hash strategy used in this Bloom filter.
</span>220 <span style=''>  type BloomType = BlockSplitBloomFilterImpl
</span>221 <span style=''>
</span>222 <span style=''>  /*
</span>223 <span style=''>   * @param iMinimumBytes The minimum bytes of the Bloom filter.
</span>224 <span style=''> * @param iMaximumBytes The maximum bytes of the Bloom filter.
</span>225 <span style=''>
</span>226 <span style=''>   */
</span>227 <span style=''>//  require(iMinimumBytes &lt;= iMaximumBytes, &quot;the minimum bytes should be less or equal than maximum bytes&quot;)
</span>228 <span style=''>  </span><span style='background: #AEF1AE'>require(hashStrategy == BloomFilter.XXH64, </span><span style='background: #F0ADAD'>s&quot;Unsupported hash strategy $hashStrategy&quot;</span><span style='background: #AEF1AE'>)</span><span style=''>
</span>229 <span style=''>
</span>230 <span style=''>  </span><span style='background: #AEF1AE'>cacheBuffer.order(ByteOrder.LITTLE_ENDIAN)</span><span style=''>
</span>231 <span style=''>
</span>232 <span style=''>  override def intBuffer: IntBuffer = </span><span style='background: #AEF1AE'>intBufferGen.get().buffer</span><span style=''>
</span>233 <span style=''>
</span>234 <span style=''>  /**
</span>235 <span style=''>   * Constructor of block-based Bloom filter backed by an array of the correct size
</span>236 <span style=''>   *
</span>237 <span style=''>   * @param numBytes The number of bytes for Bloom filter bitset. The range of num_bytes should be within
</span>238 <span style=''>   *                 [DEFAULT_MINIMUM_BYTES, DEFAULT_MAXIMUM_BYTES], it will be rounded up/down
</span>239 <span style=''>   *                 to lower/upper bound if num_bytes is out of range. It will also be rounded up to a power
</span>240 <span style=''>   *                 of 2. It uses XXH64 as its default hash function.
</span>241 <span style=''>   */
</span>242 <span style=''>  def this(numBytes: Int) {
</span>243 <span style=''>    </span><span style='background: #AEF1AE'>this({
</span>244 <span style=''></span><span style='background: #AEF1AE'>      val bits = BlockSplitBloomFilterImpl.createArray(numBytes, BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES, BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)
</span>245 <span style=''></span><span style='background: #AEF1AE'>      BlockSplitBloomFilterImpl.arrayBacked(bits)
</span>246 <span style=''></span><span style='background: #AEF1AE'>    }, new BloomHashImpl(BloomFilter.XXH64))</span><span style=''>
</span>247 <span style=''>  }
</span>248 <span style=''>
</span>249 <span style=''>  def insertHash(hash: Long): Unit = {
</span>250 <span style=''>    val numBlocks = </span><span style='background: #AEF1AE'>getBitsetSize / BlockSplitBloomFilterImpl.BYTES_PER_BLOCK</span><span style=''>
</span>251 <span style=''>    val lowHash = </span><span style='background: #AEF1AE'>hash &gt;&gt;&gt; 32</span><span style=''>
</span>252 <span style=''>    val blockIndex = (</span><span style='background: #AEF1AE'>(lowHash * numBlocks) &gt;&gt; 32).toInt</span><span style=''>
</span>253 <span style=''>    val key = </span><span style='background: #AEF1AE'>hash.toInt</span><span style=''>
</span>254 <span style=''>    // Calculate mask for bucket.
</span>255 <span style=''>    val mask = </span><span style='background: #AEF1AE'>setMask(key)</span><span style=''>
</span>256 <span style=''>    </span><span style='background: #AEF1AE'>for (i &lt;- 0 until BlockSplitBloomFilterImpl.BITS_SET_PER_BLOCK) {
</span>257 <span style=''></span><span style='background: #AEF1AE'>      var value = intBuffer.get(blockIndex * (BlockSplitBloomFilterImpl.BYTES_PER_BLOCK / 4) + i)
</span>258 <span style=''></span><span style='background: #AEF1AE'>      value |= mask(i)
</span>259 <span style=''></span><span style='background: #AEF1AE'>      intBuffer.put(blockIndex * (BlockSplitBloomFilterImpl.BYTES_PER_BLOCK / 4) + i, value)
</span>260 <span style=''></span><span style='background: #AEF1AE'>    }</span><span style=''>
</span>261 <span style=''>  }
</span>262 <span style=''>
</span>263 <span style=''>  /** CTw added the or'ing */
</span>264 <span style=''>  override def |= (that: BlockSplitBloomFilterImpl): BlockSplitBloomFilterImpl = {
</span>265 <span style=''>    </span><span style='background: #AEF1AE'>checkCompatibility(that)</span><span style=''>
</span>266 <span style=''>    // Breeze copies but we'll do in place
</span>267 <span style=''>    </span><span style='background: #AEF1AE'>for(i &lt;- 0 until intBuffer.limit()) {
</span>268 <span style=''></span><span style='background: #AEF1AE'>      intBuffer.put(i, intBuffer.get(i) | that.intBuffer.get(i))</span><span style=''>
</span>269 <span style=''>    }
</span>270 <span style=''>    this
</span>271 <span style=''>  }
</span>272 <span style=''>
</span>273 <span style=''>  private def checkCompatibility(that: BloomFilter[Array[Byte]]): Unit =
</span>274 <span style=''>    </span><span style='background: #AEF1AE'>require(that.getBitsetSize == this.getBitsetSize, </span><span style='background: #F0ADAD'>&quot;Must have the same number of buckets to intersect&quot;</span><span style='background: #AEF1AE'>)</span><span style=''>
</span>275 <span style=''>
</span>276 <span style=''>  def getBitsetSize: Int = </span><span style='background: #AEF1AE'>this.intBuffer.limit() * 4</span><span style=''>
</span>277 <span style=''>
</span>278 <span style=''>  override def equals(other: Any): Boolean =
</span>279 <span style=''>    other match {
</span>280 <span style=''>      case bs: BlockSplitBloomFilterImpl if </span><span style='background: #F0ADAD'>bs eq this</span><span style=''> =&gt; </span><span style='background: #F0ADAD'>true</span><span style=''>
</span>281 <span style=''>      case that: BlockSplitBloomFilterImpl =&gt;
</span>282 <span style=''>        </span><span style='background: #F0ADAD'>BlockSplitBloomFilterImpl.bufferEquals(this.intBuffer, that.intBuffer) &amp;&amp; (this.getAlgorithm eq that.getAlgorithm) &amp;&amp; (this.hashStrategy eq that.hashStrategy)</span><span style=''>
</span>283 <span style=''>      case _ =&gt; </span><span style='background: #F0ADAD'>false</span><span style=''>
</span>284 <span style=''>    }
</span>285 <span style=''>
</span>286 <span style=''>  def getHashStrategy: BloomFilter.HashStrategy = </span><span style='background: #F0ADAD'>BloomFilter.XXH64</span><span style=''>
</span>287 <span style=''>
</span>288 <span style=''>  def getAlgorithm: BloomFilter.Algorithm = </span><span style='background: #F0ADAD'>BloomFilter.BLOCK</span><span style=''>
</span>289 <span style=''>
</span>290 <span style=''>  def getCompression: BloomFilter.Compression = </span><span style='background: #F0ADAD'>BloomFilter.UNCOMPRESSED</span><span style=''>
</span>291 <span style=''>
</span>292 <span style=''>  def hash(value: Int): Long = {
</span>293 <span style=''>    </span><span style='background: #F0ADAD'>cacheBuffer.putInt(value)</span><span style=''>
</span>294 <span style=''>    </span><span style='background: #F0ADAD'>doHash</span><span style=''>
</span>295 <span style=''>  }
</span>296 <span style=''>
</span>297 <span style=''>  def hash(value: Long): Long = {
</span>298 <span style=''>    </span><span style='background: #F0ADAD'>cacheBuffer.putLong(value)</span><span style=''>
</span>299 <span style=''>    </span><span style='background: #F0ADAD'>doHash</span><span style=''>
</span>300 <span style=''>  }
</span>301 <span style=''>
</span>302 <span style=''>  def hash(value: Double): Long = {
</span>303 <span style=''>    </span><span style='background: #F0ADAD'>cacheBuffer.putDouble(value)</span><span style=''>
</span>304 <span style=''>    </span><span style='background: #F0ADAD'>doHash</span><span style=''>
</span>305 <span style=''>  }
</span>306 <span style=''>
</span>307 <span style=''>  def hash(value: Float): Long = {
</span>308 <span style=''>    </span><span style='background: #F0ADAD'>cacheBuffer.putFloat(value)</span><span style=''>
</span>309 <span style=''>    </span><span style='background: #F0ADAD'>doHash</span><span style=''>
</span>310 <span style=''>  }
</span>311 <span style=''>
</span>312 <span style=''>  def hash(value: BloomFilter.Binary): Long = </span><span style='background: #F0ADAD'>hashFunction.hashBytes(value)</span><span style=''>
</span>313 <span style=''>
</span>314 <span style=''>  override def serialized: Array[Byte] = {
</span>315 <span style=''>    val a = </span><span style='background: #AEF1AE'>Array.ofDim[Byte](getBitsetSize)</span><span style=''>
</span>316 <span style=''>    val copy = </span><span style='background: #AEF1AE'>ByteBuffer.wrap(a).order(ByteOrder.LITTLE_ENDIAN).asIntBuffer()</span><span style=''>
</span>317 <span style=''>    </span><span style='background: #AEF1AE'>copy.put(intBuffer)</span><span style=''>
</span>318 <span style=''>      // now in a
</span>319 <span style=''>    a
</span>320 <span style=''>  }
</span>321 <span style=''>
</span>322 <span style=''>}
</span></pre>
          </div>
          <div class="tab-pane" id="statementlist">
            <table cellspacing="0" cellpadding="0" class="table statementlist">
      <tr>
        <th>Line</th>
        <th>Stmt Id</th>
        <th>Pos</th>
        <th>Tree</th>
        <th>Symbol</th>
        <th>Tests</th>
        <th>Code</th>
      </tr><tr>
        <td>
          43
        </td>
        <td>
          3286
        </td>
        <td>
          1589
          -
          1637
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;FPP should be less than 1.0 and great than 0.0&quot;
        </td>
      </tr><tr>
        <td>
          43
        </td>
        <td>
          3283
        </td>
        <td>
          1573
          -
          1576
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0.0
        </td>
      </tr><tr>
        <td>
          43
        </td>
        <td>
          3285
        </td>
        <td>
          1569
          -
          1587
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          p.&gt;(0.0).&amp;&amp;(p.&lt;(1.0))
        </td>
      </tr><tr>
        <td>
          43
        </td>
        <td>
          3284
        </td>
        <td>
          1580
          -
          1587
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Double.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          p.&lt;(1.0)
        </td>
      </tr><tr>
        <td>
          43
        </td>
        <td>
          3287
        </td>
        <td>
          1561
          -
          1638
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Predef.require
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.require(p.&gt;(0.0).&amp;&amp;(p.&lt;(1.0)), &quot;FPP should be less than 1.0 and great than 0.0&quot;)
        </td>
      </tr><tr>
        <td>
          44
        </td>
        <td>
          3289
        </td>
        <td>
          1669
          -
          1670
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1
        </td>
      </tr><tr>
        <td>
          44
        </td>
        <td>
          3292
        </td>
        <td>
          1660
          -
          1694
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Math.log
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Math.log(1.-(java.lang.Math.pow(p, 0.125)))
        </td>
      </tr><tr>
        <td>
          44
        </td>
        <td>
          3291
        </td>
        <td>
          1669
          -
          1693
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.-
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1.-(java.lang.Math.pow(p, 0.125))
        </td>
      </tr><tr>
        <td>
          44
        </td>
        <td>
          3288
        </td>
        <td>
          1651
          -
          1653
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          -8
        </td>
      </tr><tr>
        <td>
          44
        </td>
        <td>
          3290
        </td>
        <td>
          1673
          -
          1693
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Math.pow
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Math.pow(p, 0.125)
        </td>
      </tr><tr>
        <td>
          44
        </td>
        <td>
          3293
        </td>
        <td>
          1651
          -
          1694
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Long./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          -8.*(n)./(java.lang.Math.log(1.-(java.lang.Math.pow(p, 0.125))))
        </td>
      </tr><tr>
        <td>
          45
        </td>
        <td>
          3294
        </td>
        <td>
          1713
          -
          1720
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Double.toInt
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          m.toInt
        </td>
      </tr><tr>
        <td>
          47
        </td>
        <td>
          3295
        </td>
        <td>
          1778
          -
          1800
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES.&lt;&lt;(3)
        </td>
      </tr><tr>
        <td>
          47
        </td>
        <td>
          3301
        </td>
        <td>
          1763
          -
          1763
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          47
        </td>
        <td>
          3300
        </td>
        <td>
          1763
          -
          1763
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          47
        </td>
        <td>
          3297
        </td>
        <td>
          1767
          -
          1810
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.||
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBits.&gt;(com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES.&lt;&lt;(3)).||(m.&lt;(0))
        </td>
      </tr><tr>
        <td>
          47
        </td>
        <td>
          3296
        </td>
        <td>
          1805
          -
          1810
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Double.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          m.&lt;(0)
        </td>
      </tr><tr>
        <td>
          48
        </td>
        <td>
          3298
        </td>
        <td>
          1830
          -
          1852
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES.&lt;&lt;(3)
        </td>
      </tr><tr>
        <td>
          48
        </td>
        <td>
          3299
        </td>
        <td>
          1820
          -
          1852
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBits = com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES.&lt;&lt;(3)
        </td>
      </tr><tr>
        <td>
          52
        </td>
        <td>
          3304
        </td>
        <td>
          1969
          -
          1984
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Int.unary_~
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BITS_PER_BLOCK.unary_~
        </td>
      </tr><tr>
        <td>
          52
        </td>
        <td>
          3303
        </td>
        <td>
          1964
          -
          1965
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1
        </td>
      </tr><tr>
        <td>
          52
        </td>
        <td>
          3305
        </td>
        <td>
          1936
          -
          1984
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBits.+(com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BITS_PER_BLOCK).-(1).&amp;(com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BITS_PER_BLOCK.unary_~)
        </td>
      </tr><tr>
        <td>
          52
        </td>
        <td>
          3302
        </td>
        <td>
          1947
          -
          1961
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BITS_PER_BLOCK
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BITS_PER_BLOCK
        </td>
      </tr><tr>
        <td>
          54
        </td>
        <td>
          3307
        </td>
        <td>
          2008
          -
          2042
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBits.&lt;(com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES.&lt;&lt;(3))
        </td>
      </tr><tr>
        <td>
          54
        </td>
        <td>
          3310
        </td>
        <td>
          2004
          -
          2004
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          54
        </td>
        <td>
          3306
        </td>
        <td>
          2019
          -
          2041
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES.&lt;&lt;(3)
        </td>
      </tr><tr>
        <td>
          54
        </td>
        <td>
          3311
        </td>
        <td>
          2004
          -
          2004
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          3309
        </td>
        <td>
          2052
          -
          2084
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBits = com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES.&lt;&lt;(3)
        </td>
      </tr><tr>
        <td>
          55
        </td>
        <td>
          3308
        </td>
        <td>
          2062
          -
          2084
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES.&lt;&lt;(3)
        </td>
      </tr><tr>
        <td>
          63
        </td>
        <td>
          3313
        </td>
        <td>
          2250
          -
          2257
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Double.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          p.&lt;(1.0)
        </td>
      </tr><tr>
        <td>
          63
        </td>
        <td>
          3316
        </td>
        <td>
          2231
          -
          2308
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Predef.require
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.require(p.&gt;(0.0).&amp;&amp;(p.&lt;(1.0)), &quot;FPP should be less than 1.0 and great than 0.0&quot;)
        </td>
      </tr><tr>
        <td>
          63
        </td>
        <td>
          3312
        </td>
        <td>
          2243
          -
          2246
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0.0
        </td>
      </tr><tr>
        <td>
          63
        </td>
        <td>
          3315
        </td>
        <td>
          2259
          -
          2307
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;FPP should be less than 1.0 and great than 0.0&quot;
        </td>
      </tr><tr>
        <td>
          63
        </td>
        <td>
          3314
        </td>
        <td>
          2239
          -
          2257
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          p.&gt;(0.0).&amp;&amp;(p.&lt;(1.0))
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          3322
        </td>
        <td>
          2324
          -
          2380
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Double./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          -8L.*(n).toDouble./(java.lang.Math.log(1L.-(java.lang.Math.pow(p, 0.125))))
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          3319
        </td>
        <td>
          2358
          -
          2379
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Math.pow
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Math.pow(p, 0.125)
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          3318
        </td>
        <td>
          2353
          -
          2355
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1L
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          3321
        </td>
        <td>
          2344
          -
          2380
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Math.log
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Math.log(1L.-(java.lang.Math.pow(p, 0.125)))
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          3317
        </td>
        <td>
          2324
          -
          2327
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          -8L
        </td>
      </tr><tr>
        <td>
          64
        </td>
        <td>
          3320
        </td>
        <td>
          2353
          -
          2379
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Long.-
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          1L.-(java.lang.Math.pow(p, 0.125))
        </td>
      </tr><tr>
        <td>
          65
        </td>
        <td>
          3323
        </td>
        <td>
          2387
          -
          2395
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Double.toLong
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          m.toLong
        </td>
      </tr><tr>
        <td>
          68
        </td>
        <td>
          3324
        </td>
        <td>
          2423
          -
          2451
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Long./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          directNumberOfBits(n, p)./(8)
        </td>
      </tr><tr>
        <td>
          69
        </td>
        <td>
          3325
        </td>
        <td>
          2480
          -
          2506
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImports.this.optimalNumOfBits(n, p)./(8)
        </td>
      </tr><tr>
        <td>
          70
        </td>
        <td>
          3327
        </td>
        <td>
          2573
          -
          2609
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Integer.highestOneBit(numBytes).&lt;&lt;(1)
        </td>
      </tr><tr>
        <td>
          70
        </td>
        <td>
          3330
        </td>
        <td>
          2524
          -
          2524
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          70
        </td>
        <td>
          3326
        </td>
        <td>
          2528
          -
          2560
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.!=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes.&amp;(numBytes.-(1)).!=(0)
        </td>
      </tr><tr>
        <td>
          70
        </td>
        <td>
          3329
        </td>
        <td>
          2524
          -
          2524
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          70
        </td>
        <td>
          3328
        </td>
        <td>
          2562
          -
          2609
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes = java.lang.Integer.highestOneBit(numBytes).&lt;&lt;(1)
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3331
        </td>
        <td>
          2642
          -
          2659
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3334
        </td>
        <td>
          2688
          -
          2705
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3336
        </td>
        <td>
          2627
          -
          2627
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3333
        </td>
        <td>
          2631
          -
          2675
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.||
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes.&gt;(com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES).||(numBytes.&lt;(0))
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3332
        </td>
        <td>
          2663
          -
          2675
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes.&lt;(0)
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3335
        </td>
        <td>
          2677
          -
          2705
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes = com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          71
        </td>
        <td>
          3337
        </td>
        <td>
          2627
          -
          2627
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          74
        </td>
        <td>
          3338
        </td>
        <td>
          2866
          -
          2886
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes.&gt;(origBytes)
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          3340
        </td>
        <td>
          2895
          -
          2933
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Double./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes.toDouble./(origBytes.toDouble)
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          3339
        </td>
        <td>
          2915
          -
          2933
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Long.toDouble
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          origBytes.toDouble
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          3342
        </td>
        <td>
          2895
          -
          2946
        </td>
        <td>
          Block
        </td>
        <td>
          scala.Double.toLong
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.doubleWrapper(numBytes.toDouble./(origBytes.toDouble)).ceil.toLong
        </td>
      </tr><tr>
        <td>
          75
        </td>
        <td>
          3341
        </td>
        <td>
          2895
          -
          2946
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Double.toLong
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.doubleWrapper(numBytes.toDouble./(origBytes.toDouble)).ceil.toLong
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          3343
        </td>
        <td>
          2984
          -
          3001
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Int.toDouble
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          numBytes.toDouble
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          3345
        </td>
        <td>
          2963
          -
          3014
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Double.toLong
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.doubleWrapper(origBytes.toDouble./(numBytes.toDouble)).ceil.toLong
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          3344
        </td>
        <td>
          2963
          -
          3001
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Double./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          origBytes.toDouble./(numBytes.toDouble)
        </td>
      </tr><tr>
        <td>
          77
        </td>
        <td>
          3346
        </td>
        <td>
          2963
          -
          3014
        </td>
        <td>
          Block
        </td>
        <td>
          scala.Double.toLong
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.doubleWrapper(origBytes.toDouble./(numBytes.toDouble)).ceil.toLong
        </td>
      </tr><tr>
        <td>
          90
        </td>
        <td>
          3347
        </td>
        <td>
          3551
          -
          3553
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          32
        </td>
      </tr><tr>
        <td>
          92
        </td>
        <td>
          3348
        </td>
        <td>
          3634
          -
          3637
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          256
        </td>
      </tr><tr>
        <td>
          94
        </td>
        <td>
          3349
        </td>
        <td>
          3753
          -
          3755
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          32
        </td>
      </tr><tr>
        <td>
          96
        </td>
        <td>
          3350
        </td>
        <td>
          3861
          -
          3878
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          134217728
        </td>
      </tr><tr>
        <td>
          98
        </td>
        <td>
          3351
        </td>
        <td>
          3977
          -
          3978
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          8
        </td>
      </tr><tr>
        <td>
          101
        </td>
        <td>
          3352
        </td>
        <td>
          4175
          -
          4177
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          16
        </td>
      </tr><tr>
        <td>
          103
        </td>
        <td>
          3353
        </td>
        <td>
          4248
          -
          4252
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0.01
        </td>
      </tr><tr>
        <td>
          106
        </td>
        <td>
          3354
        </td>
        <td>
          4407
          -
          4508
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Array.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Array.apply(1203114875, 1150766481, -2010862245, -1565054819, 1884591559, 770785867, -1627633337, 1550580529)
        </td>
      </tr><tr>
        <td>
          109
        </td>
        <td>
          3355
        </td>
        <td>
          4582
          -
          4595
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.apply(bitset)
        </td>
      </tr><tr>
        <td>
          120
        </td>
        <td>
          3357
        </td>
        <td>
          4916
          -
          4948
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.apply(bitset, BloomFilter.XXH64)
        </td>
      </tr><tr>
        <td>
          120
        </td>
        <td>
          3356
        </td>
        <td>
          4930
          -
          4947
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomFilter.XXH64
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BloomFilter.XXH64
        </td>
      </tr><tr>
        <td>
          125
        </td>
        <td>
          3361
        </td>
        <td>
          5045
          -
          5190
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.utils.TransientHolder.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          com.sparkutils.quality.utils.TransientHolder.apply[com.sparkutils.quality.impl.bloom.parquet.BufferAndRaw]((() =&gt; {
  val buf: java.nio.IntBuffer = java.nio.ByteBuffer.wrap(bits).order(java.nio.ByteOrder.LITTLE_ENDIAN).asIntBuffer();
  BufferAndRaw.apply(buf, scala.Some.apply[Array[Byte]](bits))
}))
        </td>
      </tr><tr>
        <td>
          126
        </td>
        <td>
          3358
        </td>
        <td>
          5084
          -
          5148
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.asIntBuffer
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.ByteBuffer.wrap(bits).order(java.nio.ByteOrder.LITTLE_ENDIAN).asIntBuffer()
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          3360
        </td>
        <td>
          5155
          -
          5184
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BufferAndRaw.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BufferAndRaw.apply(buf, scala.Some.apply[Array[Byte]](bits))
        </td>
      </tr><tr>
        <td>
          127
        </td>
        <td>
          3359
        </td>
        <td>
          5173
          -
          5183
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Some.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Some.apply[Array[Byte]](bits)
        </td>
      </tr><tr>
        <td>
          142
        </td>
        <td>
          3363
        </td>
        <td>
          5625
          -
          5681
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.apply(BlockSplitBloomFilterImpl.this.arrayBacked(bitset), hashImpl)
        </td>
      </tr><tr>
        <td>
          142
        </td>
        <td>
          3362
        </td>
        <td>
          5651
          -
          5670
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.arrayBacked
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.arrayBacked(bitset)
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          3365
        </td>
        <td>
          6069
          -
          6116
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.apply(bitset, new BloomHashImpl(hashStrategy))
        </td>
      </tr><tr>
        <td>
          155
        </td>
        <td>
          3364
        </td>
        <td>
          6084
          -
          6115
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHashImpl.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new BloomHashImpl(hashStrategy)
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          3367
        </td>
        <td>
          6183
          -
          6212
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.==
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          left.limit().==(right.limit())
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          3385
        </td>
        <td>
          6214
          -
          6453
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          {
  var i: Int = -1;
  doWhile$1(){
    i = i.+(1);
    if (i.&lt;(right.limit()).&amp;&amp;(left.get(i).==(right.get(i))))
      doWhile$1()
    else
      ()
  };
  if (i.+(1).==(right.limit()))
    true
  else
    false
}
        </td>
      </tr><tr>
        <td>
          159
        </td>
        <td>
          3366
        </td>
        <td>
          6199
          -
          6212
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.Buffer.limit
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          right.limit()
        </td>
      </tr><tr>
        <td>
          160
        </td>
        <td>
          3368
        </td>
        <td>
          6230
          -
          6232
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          -1
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          3376
        </td>
        <td>
          6239
          -
          6239
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          3375
        </td>
        <td>
          6239
          -
          6239
        </td>
        <td>
          Block
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.doWhile$1
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          doWhile$1()
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          3374
        </td>
        <td>
          6239
          -
          6239
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.doWhile$1
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          doWhile$1()
        </td>
      </tr><tr>
        <td>
          161
        </td>
        <td>
          3377
        </td>
        <td>
          6239
          -
          6239
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          162
        </td>
        <td>
          3369
        </td>
        <td>
          6252
          -
          6258
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          i.+(1)
        </td>
      </tr><tr>
        <td>
          163
        </td>
        <td>
          3370
        </td>
        <td>
          6278
          -
          6291
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.Buffer.limit
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          right.limit()
        </td>
      </tr><tr>
        <td>
          163
        </td>
        <td>
          3372
        </td>
        <td>
          6295
          -
          6322
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.==
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          left.get(i).==(right.get(i))
        </td>
      </tr><tr>
        <td>
          163
        </td>
        <td>
          3371
        </td>
        <td>
          6310
          -
          6322
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.IntBuffer.get
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          right.get(i)
        </td>
      </tr><tr>
        <td>
          163
        </td>
        <td>
          3373
        </td>
        <td>
          6274
          -
          6322
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          i.&lt;(right.limit()).&amp;&amp;(left.get(i).==(right.get(i)))
        </td>
      </tr><tr>
        <td>
          164
        </td>
        <td>
          3379
        </td>
        <td>
          6344
          -
          6357
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.Buffer.limit
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          right.limit()
        </td>
      </tr><tr>
        <td>
          164
        </td>
        <td>
          3378
        </td>
        <td>
          6338
          -
          6339
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          1
        </td>
      </tr><tr>
        <td>
          164
        </td>
        <td>
          3380
        </td>
        <td>
          6335
          -
          6357
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.==
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          i.+(1).==(right.limit())
        </td>
      </tr><tr>
        <td>
          165
        </td>
        <td>
          3381
        </td>
        <td>
          6367
          -
          6371
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          true
        </td>
      </tr><tr>
        <td>
          165
        </td>
        <td>
          3382
        </td>
        <td>
          6367
          -
          6371
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          true
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          3384
        </td>
        <td>
          6409
          -
          6414
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          false
        </td>
      </tr><tr>
        <td>
          167
        </td>
        <td>
          3383
        </td>
        <td>
          6409
          -
          6414
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          false
        </td>
      </tr><tr>
        <td>
          169
        </td>
        <td>
          3387
        </td>
        <td>
          6465
          -
          6470
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          false
        </td>
      </tr><tr>
        <td>
          169
        </td>
        <td>
          3386
        </td>
        <td>
          6465
          -
          6470
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          false
        </td>
      </tr><tr>
        <td>
          181
        </td>
        <td>
          3389
        </td>
        <td>
          6745
          -
          6813
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.apply(BlockSplitBloomFilterImpl.this.createArray(numBytes, iMinimumBytes, iMaximumBytes), hashImpl)
        </td>
      </tr><tr>
        <td>
          181
        </td>
        <td>
          3388
        </td>
        <td>
          6751
          -
          6802
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.createArray
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.createArray(numBytes, iMinimumBytes, iMaximumBytes)
        </td>
      </tr><tr>
        <td>
          183
        </td>
        <td>
          3418
        </td>
        <td>
          6890
          -
          7738
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Array.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new Array[Byte]({
  val maximumBytes: Int = if (iMaximumBytes.&gt;(BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES).&amp;&amp;(iMaximumBytes.&lt;(BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)))
    iMaximumBytes
  else
    BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES;
  val minimumBytes: Int = if (iMinimumBytes.&gt;(BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES).&amp;&amp;(iMinimumBytes.&lt;(BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)))
    iMaximumBytes
  else
    BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES;
  var inumBytes: Int = numBytes;
  if (inumBytes.&lt;(minimumBytes))
    inumBytes = minimumBytes
  else
    ();
  if (inumBytes.&amp;(inumBytes.-(1)).!=(0))
    inumBytes = java.lang.Integer.highestOneBit(inumBytes).&lt;&lt;(1)
  else
    ();
  if (inumBytes.&gt;(maximumBytes).||(inumBytes.&lt;(0)))
    inumBytes = maximumBytes
  else
    ();
  inumBytes
})
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          3390
        </td>
        <td>
          6959
          -
          7002
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          3393
        </td>
        <td>
          6943
          -
          7065
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          iMaximumBytes.&gt;(BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES).&amp;&amp;(iMaximumBytes.&lt;(BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES))
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          3392
        </td>
        <td>
          7006
          -
          7065
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          iMaximumBytes.&lt;(BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)
        </td>
      </tr><tr>
        <td>
          187
        </td>
        <td>
          3391
        </td>
        <td>
          7022
          -
          7065
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          188
        </td>
        <td>
          3394
        </td>
        <td>
          7075
          -
          7088
        </td>
        <td>
          Ident
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.iMaximumBytes
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          iMaximumBytes
        </td>
      </tr><tr>
        <td>
          190
        </td>
        <td>
          3396
        </td>
        <td>
          7108
          -
          7151
        </td>
        <td>
          Block
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          190
        </td>
        <td>
          3395
        </td>
        <td>
          7108
          -
          7151
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          192
        </td>
        <td>
          3399
        </td>
        <td>
          7248
          -
          7307
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          iMinimumBytes.&lt;(BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)
        </td>
      </tr><tr>
        <td>
          192
        </td>
        <td>
          3398
        </td>
        <td>
          7264
          -
          7307
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          192
        </td>
        <td>
          3397
        </td>
        <td>
          7201
          -
          7244
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          192
        </td>
        <td>
          3400
        </td>
        <td>
          7185
          -
          7307
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          iMinimumBytes.&gt;(BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES).&amp;&amp;(iMinimumBytes.&lt;(BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES))
        </td>
      </tr><tr>
        <td>
          193
        </td>
        <td>
          3401
        </td>
        <td>
          7317
          -
          7330
        </td>
        <td>
          Ident
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.iMaximumBytes
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          iMaximumBytes
        </td>
      </tr><tr>
        <td>
          195
        </td>
        <td>
          3403
        </td>
        <td>
          7350
          -
          7393
        </td>
        <td>
          Block
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          195
        </td>
        <td>
          3402
        </td>
        <td>
          7350
          -
          7393
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          3404
        </td>
        <td>
          7432
          -
          7456
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inumBytes.&lt;(minimumBytes)
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          3407
        </td>
        <td>
          7428
          -
          7428
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          198
        </td>
        <td>
          3406
        </td>
        <td>
          7428
          -
          7428
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          199
        </td>
        <td>
          3405
        </td>
        <td>
          7466
          -
          7490
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          inumBytes = minimumBytes
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          3412
        </td>
        <td>
          7553
          -
          7553
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          3411
        </td>
        <td>
          7553
          -
          7553
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          ()
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          3408
        </td>
        <td>
          7557
          -
          7591
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.!=
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inumBytes.&amp;(inumBytes.-(1)).!=(0)
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          3410
        </td>
        <td>
          7593
          -
          7642
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inumBytes = java.lang.Integer.highestOneBit(inumBytes).&lt;&lt;(1)
        </td>
      </tr><tr>
        <td>
          202
        </td>
        <td>
          3409
        </td>
        <td>
          7605
          -
          7642
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.lang.Integer.highestOneBit(inumBytes).&lt;&lt;(1)
        </td>
      </tr><tr>
        <td>
          203
        </td>
        <td>
          3414
        </td>
        <td>
          7651
          -
          7692
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.||
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inumBytes.&gt;(maximumBytes).||(inumBytes.&lt;(0))
        </td>
      </tr><tr>
        <td>
          203
        </td>
        <td>
          3417
        </td>
        <td>
          7647
          -
          7647
        </td>
        <td>
          Block
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          203
        </td>
        <td>
          3413
        </td>
        <td>
          7679
          -
          7692
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.&lt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          inumBytes.&lt;(0)
        </td>
      </tr><tr>
        <td>
          203
        </td>
        <td>
          3416
        </td>
        <td>
          7647
          -
          7647
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          203
        </td>
        <td>
          3415
        </td>
        <td>
          7694
          -
          7718
        </td>
        <td>
          Assign
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          inumBytes = maximumBytes
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3421
        </td>
        <td>
          8582
          -
          8609
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Unsupported hash strategy &quot;
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3420
        </td>
        <td>
          8545
          -
          8578
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.==
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.hashStrategy.==(BloomFilter.XXH64)
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3423
        </td>
        <td>
          8609
          -
          8621
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.DelegatingBloomHash.hashStrategy
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.hashStrategy
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3425
        </td>
        <td>
          8537
          -
          8623
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Predef.require
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.require(BlockSplitBloomFilterImpl.this.hashStrategy.==(BloomFilter.XXH64), scala.StringContext.apply(&quot;Unsupported hash strategy &quot;, &quot;&quot;).s(BlockSplitBloomFilterImpl.this.hashStrategy))
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3419
        </td>
        <td>
          8561
          -
          8578
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomFilter.XXH64
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BloomFilter.XXH64
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3422
        </td>
        <td>
          8621
          -
          8622
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;&quot;
        </td>
      </tr><tr>
        <td>
          228
        </td>
        <td>
          3424
        </td>
        <td>
          8580
          -
          8622
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.StringContext.s
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          scala.StringContext.apply(&quot;Unsupported hash strategy &quot;, &quot;&quot;).s(BlockSplitBloomFilterImpl.this.hashStrategy)
        </td>
      </tr><tr>
        <td>
          230
        </td>
        <td>
          3426
        </td>
        <td>
          8645
          -
          8668
        </td>
        <td>
          Select
        </td>
        <td>
          java.nio.ByteOrder.LITTLE_ENDIAN
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.ByteOrder.LITTLE_ENDIAN
        </td>
      </tr><tr>
        <td>
          230
        </td>
        <td>
          3427
        </td>
        <td>
          8627
          -
          8669
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.order
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.cacheBuffer.order(java.nio.ByteOrder.LITTLE_ENDIAN)
        </td>
      </tr><tr>
        <td>
          232
        </td>
        <td>
          3428
        </td>
        <td>
          8709
          -
          8734
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BufferAndRaw.buffer
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBufferGen.get().buffer
        </td>
      </tr><tr>
        <td>
          242
        </td>
        <td>
          3436
        </td>
        <td>
          9246
          -
          9246
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          ()
        </td>
      </tr><tr>
        <td>
          243
        </td>
        <td>
          3435
        </td>
        <td>
          9252
          -
          9508
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.&lt;init&gt;({
  val bits: Array[Byte] = BlockSplitBloomFilterImpl.createArray(numBytes, BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES, BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES);
  BlockSplitBloomFilterImpl.arrayBacked(bits)
}, new BloomHashImpl(BloomFilter.XXH64))
        </td>
      </tr><tr>
        <td>
          244
        </td>
        <td>
          3430
        </td>
        <td>
          9369
          -
          9412
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          244
        </td>
        <td>
          3429
        </td>
        <td>
          9324
          -
          9367
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES
        </td>
      </tr><tr>
        <td>
          244
        </td>
        <td>
          3431
        </td>
        <td>
          9276
          -
          9413
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.createArray
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.createArray(numBytes, BlockSplitBloomFilterImpl.LOWER_BOUND_BYTES, BlockSplitBloomFilterImpl.UPPER_BOUND_BYTES)
        </td>
      </tr><tr>
        <td>
          245
        </td>
        <td>
          3432
        </td>
        <td>
          9420
          -
          9463
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.arrayBacked
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.arrayBacked(bits)
        </td>
      </tr><tr>
        <td>
          246
        </td>
        <td>
          3434
        </td>
        <td>
          9471
          -
          9507
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHashImpl.&lt;init&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          new BloomHashImpl(BloomFilter.XXH64)
        </td>
      </tr><tr>
        <td>
          246
        </td>
        <td>
          3433
        </td>
        <td>
          9489
          -
          9506
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomFilter.XXH64
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BloomFilter.XXH64
        </td>
      </tr><tr>
        <td>
          250
        </td>
        <td>
          3438
        </td>
        <td>
          9573
          -
          9630
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int./
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.getBitsetSize./(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK)
        </td>
      </tr><tr>
        <td>
          250
        </td>
        <td>
          3437
        </td>
        <td>
          9589
          -
          9630
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BYTES_PER_BLOCK
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.BYTES_PER_BLOCK
        </td>
      </tr><tr>
        <td>
          251
        </td>
        <td>
          3439
        </td>
        <td>
          9649
          -
          9660
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Long.&gt;&gt;&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          hash.&gt;&gt;&gt;(32)
        </td>
      </tr><tr>
        <td>
          252
        </td>
        <td>
          3441
        </td>
        <td>
          9683
          -
          9717
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Long.toInt
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          lowHash.*(numBlocks).&gt;&gt;(32).toInt
        </td>
      </tr><tr>
        <td>
          252
        </td>
        <td>
          3440
        </td>
        <td>
          9708
          -
          9710
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          32
        </td>
      </tr><tr>
        <td>
          253
        </td>
        <td>
          3442
        </td>
        <td>
          9732
          -
          9742
        </td>
        <td>
          Select
        </td>
        <td>
          scala.Long.toInt
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          hash.toInt
        </td>
      </tr><tr>
        <td>
          255
        </td>
        <td>
          3443
        </td>
        <td>
          9792
          -
          9804
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHash.setMask
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.setMask(key)
        </td>
      </tr><tr>
        <td>
          256
        </td>
        <td>
          3444
        </td>
        <td>
          9819
          -
          9820
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          256
        </td>
        <td>
          3452
        </td>
        <td>
          9809
          -
          10094
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.immutable.Range.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.intWrapper(0).until(BlockSplitBloomFilterImpl.BITS_SET_PER_BLOCK).foreach[java.nio.IntBuffer](((i: Int) =&gt; {
  var value: Int = BlockSplitBloomFilterImpl.this.intBuffer.get(blockIndex.*(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK./(4)).+(i));
  value = value.|(mask.apply(i));
  BlockSplitBloomFilterImpl.this.intBuffer.put(blockIndex.*(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK./(4)).+(i), value)
}))
        </td>
      </tr><tr>
        <td>
          256
        </td>
        <td>
          3445
        </td>
        <td>
          9827
          -
          9871
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.BITS_SET_PER_BLOCK
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.BITS_SET_PER_BLOCK
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          3447
        </td>
        <td>
          9893
          -
          9972
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.IntBuffer.get
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBuffer.get(blockIndex.*(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK./(4)).+(i))
        </td>
      </tr><tr>
        <td>
          257
        </td>
        <td>
          3446
        </td>
        <td>
          9907
          -
          9971
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          blockIndex.*(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK./(4)).+(i)
        </td>
      </tr><tr>
        <td>
          258
        </td>
        <td>
          3449
        </td>
        <td>
          9979
          -
          9995
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.|
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          value.|(mask.apply(i))
        </td>
      </tr><tr>
        <td>
          258
        </td>
        <td>
          3448
        </td>
        <td>
          9988
          -
          9995
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Array.apply
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          mask.apply(i)
        </td>
      </tr><tr>
        <td>
          259
        </td>
        <td>
          3450
        </td>
        <td>
          10016
          -
          10080
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.+
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          blockIndex.*(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK./(4)).+(i)
        </td>
      </tr><tr>
        <td>
          259
        </td>
        <td>
          3451
        </td>
        <td>
          10002
          -
          10088
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.IntBuffer.put
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBuffer.put(blockIndex.*(BlockSplitBloomFilterImpl.BYTES_PER_BLOCK./(4)).+(i), value)
        </td>
      </tr><tr>
        <td>
          265
        </td>
        <td>
          3453
        </td>
        <td>
          10217
          -
          10241
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.checkCompatibility
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.checkCompatibility(that)
        </td>
      </tr><tr>
        <td>
          267
        </td>
        <td>
          3459
        </td>
        <td>
          10289
          -
          10391
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.collection.immutable.Range.foreach
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.intWrapper(0).until(BlockSplitBloomFilterImpl.this.intBuffer.limit()).foreach[java.nio.IntBuffer](((i: Int) =&gt; BlockSplitBloomFilterImpl.this.intBuffer.put(i, BlockSplitBloomFilterImpl.this.intBuffer.get(i).|(that.intBuffer.get(i)))))
        </td>
      </tr><tr>
        <td>
          267
        </td>
        <td>
          3455
        </td>
        <td>
          10306
          -
          10323
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.Buffer.limit
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBuffer.limit()
        </td>
      </tr><tr>
        <td>
          267
        </td>
        <td>
          3454
        </td>
        <td>
          10298
          -
          10299
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          0
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          3456
        </td>
        <td>
          10369
          -
          10390
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.IntBuffer.get
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          that.intBuffer.get(i)
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          3458
        </td>
        <td>
          10333
          -
          10391
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.IntBuffer.put
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBuffer.put(i, BlockSplitBloomFilterImpl.this.intBuffer.get(i).|(that.intBuffer.get(i)))
        </td>
      </tr><tr>
        <td>
          268
        </td>
        <td>
          3457
        </td>
        <td>
          10350
          -
          10390
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.|
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBuffer.get(i).|(that.intBuffer.get(i))
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          3462
        </td>
        <td>
          10539
          -
          10590
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          &quot;Must have the same number of buckets to intersect&quot;
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          3461
        </td>
        <td>
          10497
          -
          10537
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.==
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          that.getBitsetSize.==(this.getBitsetSize)
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          3460
        </td>
        <td>
          10519
          -
          10537
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.getBitsetSize
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          this.getBitsetSize
        </td>
      </tr><tr>
        <td>
          274
        </td>
        <td>
          3463
        </td>
        <td>
          10489
          -
          10591
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Predef.require
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Predef.require(that.getBitsetSize.==(this.getBitsetSize), &quot;Must have the same number of buckets to intersect&quot;)
        </td>
      </tr><tr>
        <td>
          276
        </td>
        <td>
          3464
        </td>
        <td>
          10620
          -
          10646
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Int.*
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          this.intBuffer.limit().*(4)
        </td>
      </tr><tr>
        <td>
          280
        </td>
        <td>
          3465
        </td>
        <td>
          10755
          -
          10765
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.eq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          bs.eq(this)
        </td>
      </tr><tr>
        <td>
          280
        </td>
        <td>
          3466
        </td>
        <td>
          10769
          -
          10773
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          true
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3471
        </td>
        <td>
          10968
          -
          10985
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.DelegatingBloomHash.hashStrategy
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          that.hashStrategy
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3468
        </td>
        <td>
          10883
          -
          10897
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.intBuffer
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          that.intBuffer
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3470
        </td>
        <td>
          10903
          -
          10941
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.eq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          this.getAlgorithm.eq(that.getAlgorithm)
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3473
        </td>
        <td>
          10828
          -
          10986
        </td>
        <td>
          Apply
        </td>
        <td>
          scala.Boolean.&amp;&amp;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.bufferEquals(this.intBuffer, that.intBuffer).&amp;&amp;(this.getAlgorithm.eq(that.getAlgorithm)).&amp;&amp;(this.hashStrategy.eq(that.hashStrategy))
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3467
        </td>
        <td>
          10867
          -
          10881
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.intBuffer
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          this.intBuffer
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3469
        </td>
        <td>
          10924
          -
          10941
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.getAlgorithm
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          that.getAlgorithm
        </td>
      </tr><tr>
        <td>
          282
        </td>
        <td>
          3472
        </td>
        <td>
          10947
          -
          10985
        </td>
        <td>
          Apply
        </td>
        <td>
          java.lang.Object.eq
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          this.hashStrategy.eq(that.hashStrategy)
        </td>
      </tr><tr>
        <td>
          283
        </td>
        <td>
          3474
        </td>
        <td>
          11003
          -
          11008
        </td>
        <td>
          Literal
        </td>
        <td>
          &lt;nosymbol&gt;
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          false
        </td>
      </tr><tr>
        <td>
          286
        </td>
        <td>
          3475
        </td>
        <td>
          11066
          -
          11083
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomFilter.XXH64
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BloomFilter.XXH64
        </td>
      </tr><tr>
        <td>
          288
        </td>
        <td>
          3476
        </td>
        <td>
          11129
          -
          11146
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomFilter.BLOCK
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BloomFilter.BLOCK
        </td>
      </tr><tr>
        <td>
          290
        </td>
        <td>
          3477
        </td>
        <td>
          11196
          -
          11220
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomFilter.UNCOMPRESSED
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BloomFilter.UNCOMPRESSED
        </td>
      </tr><tr>
        <td>
          293
        </td>
        <td>
          3478
        </td>
        <td>
          11259
          -
          11284
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.putInt
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.cacheBuffer.putInt(value)
        </td>
      </tr><tr>
        <td>
          294
        </td>
        <td>
          3479
        </td>
        <td>
          11289
          -
          11295
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHash.doHash
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.doHash
        </td>
      </tr><tr>
        <td>
          298
        </td>
        <td>
          3480
        </td>
        <td>
          11339
          -
          11365
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.putLong
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.cacheBuffer.putLong(value)
        </td>
      </tr><tr>
        <td>
          299
        </td>
        <td>
          3481
        </td>
        <td>
          11370
          -
          11376
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHash.doHash
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.doHash
        </td>
      </tr><tr>
        <td>
          303
        </td>
        <td>
          3482
        </td>
        <td>
          11422
          -
          11450
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.putDouble
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.cacheBuffer.putDouble(value)
        </td>
      </tr><tr>
        <td>
          304
        </td>
        <td>
          3483
        </td>
        <td>
          11455
          -
          11461
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHash.doHash
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.doHash
        </td>
      </tr><tr>
        <td>
          308
        </td>
        <td>
          3484
        </td>
        <td>
          11506
          -
          11533
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.putFloat
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.cacheBuffer.putFloat(value)
        </td>
      </tr><tr>
        <td>
          309
        </td>
        <td>
          3485
        </td>
        <td>
          11538
          -
          11544
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BloomHash.doHash
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.doHash
        </td>
      </tr><tr>
        <td>
          312
        </td>
        <td>
          3486
        </td>
        <td>
          11596
          -
          11625
        </td>
        <td>
          Apply
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.XxHash.hashBytes
        </td>
        <td>
          
        </td>
        <td style="background: #F0ADAD">
          BlockSplitBloomFilterImpl.this.hashFunction.hashBytes(value)
        </td>
      </tr><tr>
        <td>
          315
        </td>
        <td>
          3488
        </td>
        <td>
          11682
          -
          11714
        </td>
        <td>
          ApplyToImplicitArgs
        </td>
        <td>
          scala.Array.ofDim
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          scala.Array.ofDim[Byte](BlockSplitBloomFilterImpl.this.getBitsetSize)((ClassTag.Byte: scala.reflect.ClassTag[Byte]))
        </td>
      </tr><tr>
        <td>
          315
        </td>
        <td>
          3487
        </td>
        <td>
          11700
          -
          11713
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.getBitsetSize
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.getBitsetSize
        </td>
      </tr><tr>
        <td>
          316
        </td>
        <td>
          3489
        </td>
        <td>
          11730
          -
          11793
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.ByteBuffer.asIntBuffer
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          java.nio.ByteBuffer.wrap(a).order(java.nio.ByteOrder.LITTLE_ENDIAN).asIntBuffer()
        </td>
      </tr><tr>
        <td>
          317
        </td>
        <td>
          3491
        </td>
        <td>
          11798
          -
          11817
        </td>
        <td>
          Apply
        </td>
        <td>
          java.nio.IntBuffer.put
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          copy.put(BlockSplitBloomFilterImpl.this.intBuffer)
        </td>
      </tr><tr>
        <td>
          317
        </td>
        <td>
          3490
        </td>
        <td>
          11807
          -
          11816
        </td>
        <td>
          Select
        </td>
        <td>
          com.sparkutils.quality.impl.bloom.parquet.BlockSplitBloomFilterImpl.intBuffer
        </td>
        <td>
          
        </td>
        <td style="background: #AEF1AE">
          BlockSplitBloomFilterImpl.this.intBuffer
        </td>
      </tr>
    </table>
          </div>
        </div>
      </body>
    </html>